System.register(["./OrbitControls-legacy.1f04e8e4.js","./GLTFLoader-legacy.3fb5d659.js","./lil-gui.esm-legacy.bf105428.js","./index-legacy.7b4e3796.js"],(function(e,t){"use strict";var s,i,n,a,r,h,o,c,l,d,u,p,m,g,w,f,x,b,v,y,L,M,k;return{setters:[e=>{s=e.P,i=e.O,n=e.W,a=e.s,r=e.f,h=e.ap,o=e.q,c=e.C,l=e.D,d=e.aq,u=e.M,p=e.b,m=e.ao,g=e.x,w=e.c,f=e.an,x=e.S},e=>{b=e.G},e=>{v=e.G},e=>{y=e.a,L=e.b,M=e.c,k=e.d}],execute:function(){class z{constructor(){this.callbacks={},this.callbacks.base={}}on(e,t){return void 0===e||""===e?(console.warn("wrong names"),!1):void 0===t?(console.warn("wrong callback"),!1):(this.resolveNames(e).forEach((e=>{const s=this.resolveName(e);this.callbacks[s.namespace]instanceof Object||(this.callbacks[s.namespace]={}),this.callbacks[s.namespace][s.value]instanceof Array||(this.callbacks[s.namespace][s.value]=[]),this.callbacks[s.namespace][s.value].push(t)})),this)}off(e){return void 0===e||""===e?(console.warn("wrong name"),!1):(this.resolveNames(e).forEach((e=>{const t=this.resolveName(e);if("base"!==t.namespace&&""===t.value)delete this.callbacks[t.namespace];else if("base"===t.namespace)for(const s in this.callbacks)this.callbacks[s]instanceof Object&&this.callbacks[s][t.value]instanceof Array&&(delete this.callbacks[s][t.value],0===Object.keys(this.callbacks[s]).length&&delete this.callbacks[s]);else this.callbacks[t.namespace]instanceof Object&&this.callbacks[t.namespace][t.value]instanceof Array&&(delete this.callbacks[t.namespace][t.value],0===Object.keys(this.callbacks[t.namespace]).length&&delete this.callbacks[t.namespace])})),this)}trigger(e,t){if(void 0===e||""===e)return console.warn("wrong name"),!1;const s=t instanceof Array?t:[];let i=this.resolveNames(e);if(i=this.resolveName(i[0]),"base"===i.namespace)for(const n in this.callbacks)this.callbacks[n]instanceof Object&&this.callbacks[n][i.value]instanceof Array&&this.callbacks[n][i.value].forEach((function(e){e.apply(this,s)}));else if(this.callbacks[i.namespace]instanceof Object){if(""===i.value)return console.warn("wrong name"),this;this.callbacks[i.namespace][i.value].forEach((function(e){e.apply(this,s)}))}return null}resolveNames(e){let t=e;return t=t.replace(/[^a-zA-Z0-9 ,/.]/g,""),t=t.replace(/[,/]+/g," "),t=t.split(" "),t}resolveName(e){const t={},s=e.split(".");return t.original=e,t.value=s[0],t.namespace="base",s.length>1&&""!==s[1]&&(t.namespace=s[1]),t}}class R extends z{constructor(){super(),this.width=window.innerWidth,this.height=window.innerHeight,this.pixelRatio=Math.min(window.devicePixelRatio,2),window.addEventListener("resize",(()=>{this.width=window.innerWidth,this.height=window.innerHeight,this.pixelRatio=Math.min(window.devicePixelRatio,2),this.trigger("resize")}))}}class j extends z{constructor(){super(),this.start=Date.now(),this.current=this.start,this.elapsed=0,this.delta=16,window.requestAnimationFrame((()=>{this.tick()}))}tick(){const e=Date.now();this.delta=e-this.current,this.current=e,this.elapsed=this.current-this.start,this.trigger("tick"),window.requestAnimationFrame((()=>{this.tick()}))}}class U{constructor(){this.experience=new P,this.sizes=this.experience.sizes,this.canvas=this.experience.canvas,this.scene=this.experience.scene,this.setInstance(),this.setControls()}setInstance(){this.instance=new s(35,this.sizes.width/this.sizes.height,.1,100),this.instance.position.set(6,4,8),this.scene.add(this.instance)}setControls(){this.controls=new i(this.instance,this.canvas),this.controls.enableDamping=!0}resize(){this.instance.aspect=this.sizes.width/this.sizes.height,this.instance.updateProjectionMatrix()}update(){this.controls.update()}}class F{constructor(){this.experience=new P,this.canvas=this.experience.canvas,this.sizes=this.experience.sizes,this.scene=this.experience.scene,this.camera=this.experience.camera,this.setInstance()}setInstance(){this.instance=new n({canvas:this.canvas,antialias:!0}),this.instance.physicallyCorrectLights=!0,this.instance.outputEncoding=a,this.instance.toneMapping=r,this.instance.toneMappingExposure=1.75,this.instance.shadowMap.enabled=!0,this.instance.shadowMap.type=h,this.instance.setClearColor("#211d20"),this.instance.setSize(this.sizes.width,this.sizes.height),this.instance.setPixelRatio(Math.min(this.sizes.pixelRatio,2))}resize(){this.instance.setSize(this.sizes.width,this.sizes.height),this.instance.setPixelRatio(Math.min(this.sizes.pixelRatio,2))}update(){this.instance.render(this.scene,this.camera.instance)}}class T extends z{constructor(e){super(),this.sources=e,this.items={},this.toLoad=this.sources.length,this.loaded=0,this.setLoaders(),this.startLoading()}setLoaders(){this.loaders={},this.loaders.gltfLoader=new b,this.loaders.textureLoader=new o,this.loaders.cubeTextureLoader=new c}startLoading(){this.sources.forEach((e=>{"cubeTexture"==e.type&&this.loaders.cubeTextureLoader.load(e.path,(t=>{this.sourceLoaded(e,t)})),"texture"==e.type&&this.loaders.textureLoader.load(e.path,(t=>{this.sourceLoaded(e,t)})),"gltfModel"==e.type&&this.loaders.gltfLoader.load(e.path,(t=>{this.sourceLoaded(e,t)}))}))}sourceLoaded(e,t){this.items[e.name]=t,this.loaded++,this.loaded==this.toLoad&&this.trigger("ready")}}const A=[{name:"environmentMapTexture",type:"cubeTexture",path:[new URL(""+new URL("px.a0e41bf9.jpg",t.meta.url).href,self.location).href,new URL(""+new URL("nx.57f73ba7.jpg",t.meta.url).href,self.location).href,new URL(""+new URL("py.7322f97e.jpg",t.meta.url).href,self.location).href,new URL(""+new URL("ny.d209a134.jpg",t.meta.url).href,self.location).href,new URL(""+new URL("pz.b0eb9498.jpg",t.meta.url).href,self.location).href,new URL(""+new URL("nz.fc946930.jpg",t.meta.url).href,self.location).href]},{name:"grassColorTexture",type:"texture",path:new URL(""+new URL("color.d1d3ccf3.jpg",t.meta.url).href,self.location).href},{name:"grassNormalTexture",type:"texture",path:new URL(""+new URL("normal.44eeb462.jpg",t.meta.url).href,self.location).href},{name:"foxModel",type:"gltfModel",path:new URL(""+new URL("Fox.92c71b40.glb",t.meta.url).href,self.location).href}];class S{constructor(e){this.active=window.location.hash.indexOf("#debug")>-1,this.active&&(this.ui=new v)}}class C{constructor(){this.experience=new P,this.scene=this.experience.scene,this.resources=this.experience.resources,this.debug=this.experience.debug,this.debug.active&&(this.debugFolder=this.debug.ui.addFolder("environment")),this.setSunLight(),this.setEnvironmentMap()}setSunLight(){this.sunLight=new l("#fff",1),this.sunLight.castShadow=!0,this.sunLight.shadow.camera.far=15,this.sunLight.shadow.mapSize.set(1024,1024),this.sunLight.shadow.normalBias=.05,this.sunLight.position.set(3,2,-1.25),this.scene.add(this.sunLight);const e=new d(this.sunLight);this.scene.add(e)}setEnvironmentMap(){this.environmentMap={},this.environmentMap.intensity=.4,this.environmentMap.texture=this.resources.items.environmentMapTexture,this.environmentMap.texture.encoding=a,this.scene.environment=this.environmentMap.texture,this.environmentMap.updateMaterials=()=>{this.scene.traverse((e=>{e instanceof u&&e.Material instanceof p&&(e.material.envMap=this.environmentMap.texture,e.material.envMapIntensity=this.environmentMap.intensity,e.material.needsUpdate=!0)}))},this.environmentMap.updateMaterials(),this.debug.active&&(this.debugFolder.add(this.environmentMap,"intensity").name("envMapIntensity").min(0).max(4).step(.001).onChange(this.environmentMap.updateMaterials),this.debugFolder.add(this.sunLight,"intensity").name("sunLightIntensity").min(0).max(10).step(.001),this.debugFolder.add(this.sunLight.position,"x").name("sunLightX").min(-5).max(5).step(.001),this.debugFolder.add(this.sunLight.position,"y").name("sunLightY").min(-5).max(5).step(.001),this.debugFolder.add(this.sunLight.position,"z").name("sunLightZ").min(-5).max(5).step(.001))}}class E{constructor(){this.experience=new P,this.scene=this.experience.scene,this.resources=this.experience.resources,this.setGeometry(),this.setTexture(),this.setMaterial(),this.setMesh()}setGeometry(){this.geometry=new m(5,64)}setTexture(){this.texture={},this.texture.color=this.resources.items.grassColorTexture,this.texture.color.encoding=a,this.texture.color.repeat.set(1.5,1.5),this.texture.color.wrapS=g,this.texture.color.wrapT=g,this.texture.normal=this.resources.items.grassNormalTexture,this.texture.normal.repeat.set(1.5,1.5),this.texture.normal.wrapS=g,this.texture.normal.wrapT=g}setMaterial(){this.material=new p({map:this.texture.color,normalMap:this.texture.normal,side:w})}setMesh(){this.mesh=new u(this.geometry,this.material),this.mesh.rotation.x=.5*-Math.PI,this.mesh.receiveShadow=!0,this.scene.add(this.mesh)}}class I{constructor(){this.experience=new P,this.scene=this.experience.scene,this.resources=this.experience.resources,this.time=this.experience.time,this.debug=this.experience.debug,this.debug.active&&(this.debugFolder=this.debug.ui.addFolder("fox")),this.resource=this.resources.items.foxModel,this.setModel(),this.setAnimation()}setModel(){this.model=this.resource.scene,this.model.scale.set(.02,.02,.02),this.scene.add(this.model),this.model.traverse((e=>{e instanceof u&&(e.castShadow=!0)}))}setAnimation(){if(this.animation={},this.animation.mixer=new f(this.model),this.animation.actions={},this.animation.actions.idle=this.animation.mixer.clipAction(this.resource.animations[0]),this.animation.actions.walking=this.animation.mixer.clipAction(this.resource.animations[1]),this.animation.actions.running=this.animation.mixer.clipAction(this.resource.animations[2]),this.animation.actions.current=this.animation.actions.idle,this.animation.actions.current.play(),this.animation.play=e=>{const t=this.animation.actions[e],s=this.animation.actions.current;t.reset(),t.play(),t.crossFadeFrom(s,1),this.animation.actions.current=t},this.debug.active){const e={playIdle:()=>{this.animation.play("idle")},playWalking:()=>{this.animation.play("walking")},playRunning:()=>{this.animation.play("running")}};this.debugFolder.add(e,"playIdle"),this.debugFolder.add(e,"playWalking"),this.debugFolder.add(e,"playRunning")}}update(){this.animation.mixer.update(.001*this.time.delta)}}class N{constructor(){this.experience=new P,this.scene=this.experience.scene,this.resources=this.experience.resources,this.resources.on("ready",(()=>{console.log("ready"),this.floor=new E,this.fox=new I,this.environment=new C}))}update(){this.fox&&this.fox.update()}}let O=null;class P{constructor(e){if(O)return O;O=this,window.experience=this,this.canvas=e,this.debug=new S,this.sizes=new R,this.time=new j,this.scene=new x,this.camera=new U,this.renderer=new F,this.resources=new T(A),this.world=new N,this.sizes.on("resize",(()=>{this.resize()})),this.time.on("tick",(()=>{this.update()}))}resize(){this.camera.resize(),this.renderer.resize()}update(){this.camera.update(),this.renderer.update(),this.world.update()}destroy(){this.sizes.off("resize"),this.time.off("tick"),this.scene.traverse((e=>{if(e instanceof u){e.geometry.dispose();for(const t in e.material){const s=e.material[t];s&&"function"==typeof s.dispose&&s.dispose()}}})),this.camera.controls.dispose(),this.renderer.instance.dispose(),this.debug.active&&this.debug.ui.destroy()}}const q=[k("canvas",{class:"webgl"},null,-1)];e("default",{__name:"biggerProject",setup:e=>(y((()=>{const e=document.querySelector("canvas.webgl");new P(e)})),(e,t)=>(L(),M("div",null,q)))})}}}));
