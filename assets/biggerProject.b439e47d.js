import{P as f,O as g,W as w,s as d,f as x,ap as b,q as v,C as L,D as y,aq as M,M as c,b as p,ao as k,x as h,c as z,an as R,S as F}from"./OrbitControls.0aa6d8be.js";import{G as T}from"./GLTFLoader.3487e58d.js";import{G as U}from"./lil-gui.esm.7a5dd4ff.js";import{a as j,b as S,c as C,d as E}from"./index.0281c40b.js";class u{constructor(){this.callbacks={},this.callbacks.base={}}on(e,t){return typeof e>"u"||e===""?(console.warn("wrong names"),!1):typeof t>"u"?(console.warn("wrong callback"),!1):(this.resolveNames(e).forEach(i=>{const s=this.resolveName(i);this.callbacks[s.namespace]instanceof Object||(this.callbacks[s.namespace]={}),this.callbacks[s.namespace][s.value]instanceof Array||(this.callbacks[s.namespace][s.value]=[]),this.callbacks[s.namespace][s.value].push(t)}),this)}off(e){return typeof e>"u"||e===""?(console.warn("wrong name"),!1):(this.resolveNames(e).forEach(n=>{const i=this.resolveName(n);if(i.namespace!=="base"&&i.value==="")delete this.callbacks[i.namespace];else if(i.namespace==="base")for(const s in this.callbacks)this.callbacks[s]instanceof Object&&this.callbacks[s][i.value]instanceof Array&&(delete this.callbacks[s][i.value],Object.keys(this.callbacks[s]).length===0&&delete this.callbacks[s]);else this.callbacks[i.namespace]instanceof Object&&this.callbacks[i.namespace][i.value]instanceof Array&&(delete this.callbacks[i.namespace][i.value],Object.keys(this.callbacks[i.namespace]).length===0&&delete this.callbacks[i.namespace])}),this)}trigger(e,t){if(typeof e>"u"||e==="")return console.warn("wrong name"),!1;let n=null;const i=t instanceof Array?t:[];let s=this.resolveNames(e);if(s=this.resolveName(s[0]),s.namespace==="base")for(const o in this.callbacks)this.callbacks[o]instanceof Object&&this.callbacks[o][s.value]instanceof Array&&this.callbacks[o][s.value].forEach(function(m){m.apply(this,i)});else if(this.callbacks[s.namespace]instanceof Object){if(s.value==="")return console.warn("wrong name"),this;this.callbacks[s.namespace][s.value].forEach(function(o){o.apply(this,i)})}return n}resolveNames(e){let t=e;return t=t.replace(/[^a-zA-Z0-9 ,/.]/g,""),t=t.replace(/[,/]+/g," "),t=t.split(" "),t}resolveName(e){const t={},n=e.split(".");return t.original=e,t.value=n[0],t.namespace="base",n.length>1&&n[1]!==""&&(t.namespace=n[1]),t}}class A extends u{constructor(){super(),this.width=window.innerWidth,this.height=window.innerHeight,this.pixelRatio=Math.min(window.devicePixelRatio,2),window.addEventListener("resize",()=>{this.width=window.innerWidth,this.height=window.innerHeight,this.pixelRatio=Math.min(window.devicePixelRatio,2),this.trigger("resize")})}}class N extends u{constructor(){super(),this.start=Date.now(),this.current=this.start,this.elapsed=0,this.delta=16,window.requestAnimationFrame(()=>{this.tick()})}tick(){const e=Date.now();this.delta=e-this.current,this.current=e,this.elapsed=this.current-this.start,this.trigger("tick"),window.requestAnimationFrame(()=>{this.tick()})}}class G{constructor(){this.experience=new r,this.sizes=this.experience.sizes,this.canvas=this.experience.canvas,this.scene=this.experience.scene,this.setInstance(),this.setControls()}setInstance(){this.instance=new f(35,this.sizes.width/this.sizes.height,.1,100),this.instance.position.set(6,4,8),this.scene.add(this.instance)}setControls(){this.controls=new g(this.instance,this.canvas),this.controls.enableDamping=!0}resize(){this.instance.aspect=this.sizes.width/this.sizes.height,this.instance.updateProjectionMatrix()}update(){this.controls.update()}}class I{constructor(){this.experience=new r,this.canvas=this.experience.canvas,this.sizes=this.experience.sizes,this.scene=this.experience.scene,this.camera=this.experience.camera,this.setInstance()}setInstance(){this.instance=new w({canvas:this.canvas,antialias:!0}),this.instance.physicallyCorrectLights=!0,this.instance.outputEncoding=d,this.instance.toneMapping=x,this.instance.toneMappingExposure=1.75,this.instance.shadowMap.enabled=!0,this.instance.shadowMap.type=b,this.instance.setClearColor("#211d20"),this.instance.setSize(this.sizes.width,this.sizes.height),this.instance.setPixelRatio(Math.min(this.sizes.pixelRatio,2))}resize(){this.instance.setSize(this.sizes.width,this.sizes.height),this.instance.setPixelRatio(Math.min(this.sizes.pixelRatio,2))}update(){this.instance.render(this.scene,this.camera.instance)}}class O extends u{constructor(e){super(),this.sources=e,this.items={},this.toLoad=this.sources.length,this.loaded=0,this.setLoaders(),this.startLoading()}setLoaders(){this.loaders={},this.loaders.gltfLoader=new T,this.loaders.textureLoader=new v,this.loaders.cubeTextureLoader=new L}startLoading(){this.sources.forEach(e=>{e.type=="cubeTexture"&&this.loaders.cubeTextureLoader.load(e.path,t=>{this.sourceLoaded(e,t)}),e.type=="texture"&&this.loaders.textureLoader.load(e.path,t=>{this.sourceLoaded(e,t)}),e.type=="gltfModel"&&this.loaders.gltfLoader.load(e.path,t=>{this.sourceLoaded(e,t)})})}sourceLoaded(e,t){this.items[e.name]=t,this.loaded++,this.loaded==this.toLoad&&this.trigger("ready")}}const P=new URL(""+new URL("px.a0e41bf9.jpg",import.meta.url).href,self.location).href,H=new URL(""+new URL("nx.57f73ba7.jpg",import.meta.url).href,self.location).href,D=new URL(""+new URL("py.7322f97e.jpg",import.meta.url).href,self.location).href,W=new URL(""+new URL("ny.d209a134.jpg",import.meta.url).href,self.location).href,q=new URL(""+new URL("pz.b0eb9498.jpg",import.meta.url).href,self.location).href,B=new URL(""+new URL("nz.fc946930.jpg",import.meta.url).href,self.location).href,_=new URL(""+new URL("color.d1d3ccf3.jpg",import.meta.url).href,self.location).href,Z=new URL(""+new URL("normal.44eeb462.jpg",import.meta.url).href,self.location).href,V=new URL(""+new URL("Fox.92c71b40.glb",import.meta.url).href,self.location).href,X=[{name:"environmentMapTexture",type:"cubeTexture",path:[P,H,D,W,q,B]},{name:"grassColorTexture",type:"texture",path:_},{name:"grassNormalTexture",type:"texture",path:Z},{name:"foxModel",type:"gltfModel",path:V}];class Y{constructor(e){this.active=window.location.hash.indexOf("#debug")>-1,this.active&&(this.ui=new U)}}class J{constructor(){this.experience=new r,this.scene=this.experience.scene,this.resources=this.experience.resources,this.debug=this.experience.debug,this.debug.active&&(this.debugFolder=this.debug.ui.addFolder("environment")),this.setSunLight(),this.setEnvironmentMap()}setSunLight(){this.sunLight=new y("#fff",1),this.sunLight.castShadow=!0,this.sunLight.shadow.camera.far=15,this.sunLight.shadow.mapSize.set(1024,1024),this.sunLight.shadow.normalBias=.05,this.sunLight.position.set(3,2,-1.25),this.scene.add(this.sunLight);const e=new M(this.sunLight);this.scene.add(e)}setEnvironmentMap(){this.environmentMap={},this.environmentMap.intensity=.4,this.environmentMap.texture=this.resources.items.environmentMapTexture,this.environmentMap.texture.encoding=d,this.scene.environment=this.environmentMap.texture,this.environmentMap.updateMaterials=()=>{this.scene.traverse(e=>{e instanceof c&&e.Material instanceof p&&(e.material.envMap=this.environmentMap.texture,e.material.envMapIntensity=this.environmentMap.intensity,e.material.needsUpdate=!0)})},this.environmentMap.updateMaterials(),this.debug.active&&(this.debugFolder.add(this.environmentMap,"intensity").name("envMapIntensity").min(0).max(4).step(.001).onChange(this.environmentMap.updateMaterials),this.debugFolder.add(this.sunLight,"intensity").name("sunLightIntensity").min(0).max(10).step(.001),this.debugFolder.add(this.sunLight.position,"x").name("sunLightX").min(-5).max(5).step(.001),this.debugFolder.add(this.sunLight.position,"y").name("sunLightY").min(-5).max(5).step(.001),this.debugFolder.add(this.sunLight.position,"z").name("sunLightZ").min(-5).max(5).step(.001))}}class K{constructor(){this.experience=new r,this.scene=this.experience.scene,this.resources=this.experience.resources,this.setGeometry(),this.setTexture(),this.setMaterial(),this.setMesh()}setGeometry(){this.geometry=new k(5,64)}setTexture(){this.texture={},this.texture.color=this.resources.items.grassColorTexture,this.texture.color.encoding=d,this.texture.color.repeat.set(1.5,1.5),this.texture.color.wrapS=h,this.texture.color.wrapT=h,this.texture.normal=this.resources.items.grassNormalTexture,this.texture.normal.repeat.set(1.5,1.5),this.texture.normal.wrapS=h,this.texture.normal.wrapT=h}setMaterial(){this.material=new p({map:this.texture.color,normalMap:this.texture.normal,side:z})}setMesh(){this.mesh=new c(this.geometry,this.material),this.mesh.rotation.x=-Math.PI*.5,this.mesh.receiveShadow=!0,this.scene.add(this.mesh)}}class Q{constructor(){this.experience=new r,this.scene=this.experience.scene,this.resources=this.experience.resources,this.time=this.experience.time,this.debug=this.experience.debug,this.debug.active&&(this.debugFolder=this.debug.ui.addFolder("fox")),this.resource=this.resources.items.foxModel,this.setModel(),this.setAnimation()}setModel(){this.model=this.resource.scene,this.model.scale.set(.02,.02,.02),this.scene.add(this.model),this.model.traverse(e=>{e instanceof c&&(e.castShadow=!0)})}setAnimation(){if(this.animation={},this.animation.mixer=new R(this.model),this.animation.actions={},this.animation.actions.idle=this.animation.mixer.clipAction(this.resource.animations[0]),this.animation.actions.walking=this.animation.mixer.clipAction(this.resource.animations[1]),this.animation.actions.running=this.animation.mixer.clipAction(this.resource.animations[2]),this.animation.actions.current=this.animation.actions.idle,this.animation.actions.current.play(),this.animation.play=e=>{const t=this.animation.actions[e],n=this.animation.actions.current;t.reset(),t.play(),t.crossFadeFrom(n,1),this.animation.actions.current=t},this.debug.active){const e={playIdle:()=>{this.animation.play("idle")},playWalking:()=>{this.animation.play("walking")},playRunning:()=>{this.animation.play("running")}};this.debugFolder.add(e,"playIdle"),this.debugFolder.add(e,"playWalking"),this.debugFolder.add(e,"playRunning")}}update(){this.animation.mixer.update(this.time.delta*.001)}}class ${constructor(){this.experience=new r,this.scene=this.experience.scene,this.resources=this.experience.resources,this.resources.on("ready",()=>{console.log("ready"),this.floor=new K,this.fox=new Q,this.environment=new J})}update(){this.fox&&this.fox.update()}}let l=null;class r{constructor(e){if(l)return l;l=this,window.experience=this,this.canvas=e,this.debug=new Y,this.sizes=new A,this.time=new N,this.scene=new F,this.camera=new G,this.renderer=new I,this.resources=new O(X),this.world=new $,this.sizes.on("resize",()=>{this.resize()}),this.time.on("tick",()=>{this.update()})}resize(){this.camera.resize(),this.renderer.resize()}update(){this.camera.update(),this.renderer.update(),this.world.update()}destroy(){this.sizes.off("resize"),this.time.off("tick"),this.scene.traverse(e=>{if(e instanceof c){e.geometry.dispose();for(const t in e.material){const n=e.material[t];n&&typeof n.dispose=="function"&&n.dispose()}}}),this.camera.controls.dispose(),this.renderer.instance.dispose(),this.debug.active&&this.debug.ui.destroy()}}const ee=E("canvas",{class:"webgl"},null,-1),te=[ee],re={__name:"biggerProject",setup(a){return j(()=>{const e=document.querySelector("canvas.webgl");new r(e)}),(e,t)=>(S(),C("div",null,te))}};export{re as default};
